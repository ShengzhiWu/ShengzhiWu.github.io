<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>120-Cell</title>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three/build/three.module.js"
            }
        }
	</script>
    <style>
        button {
            color: white;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 1.5em;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">
    <div id="container"></div>

    <button id="3d rotate" style="position: absolute; left: 1em; bottom: 5em; height: 3em; border: 3px solid white;">3D rotate</button>
    <button id="4d rotate" style="position: absolute; left: 1em; bottom: 1em; height: 3em; border: 3px solid rgba(0, 0, 0, 0);">4D rotate</button>

    <script type="module">
        const points = [
            [0.8506508, 6.211698E-14, -1.1135163, -3.427051], [0.26286554, 0.809017, -1.1135163, -3.427051], [-0.68819094, 0.5, -1.1135163, -3.427051], [0.4253254, 1.309017, -0.26286554, -3.427051], [0.4253254, 1.309017, -1.8017073, -2.927051], [-0.68819094, -0.5, -1.1135163, -3.427051], [-1.1135163, 0.809017, -0.26286554, -3.427051], [-1.1135163, 0.809017, -1.8017073, -2.927051], [1.3763819, -6.154799E-14, -0.26286554, -3.427051], [0.26286554, -0.809017, -1.1135163, -3.427051], [1.3763819, -4.0745185E-14, -1.8017073, -2.927051], [-1.1135163, -0.809017, -0.26286554, -3.427051], [0.4253254, -1.309017, -0.26286554, -3.427051], [0.4253254, -1.309017, -1.8017073, -2.927051], [-1.1135163, -0.809017, -1.8017073, -2.927051], [1.1135163, -0.809017, -2.2270327, -2.618034], [1.1135163, 0.809017, -2.2270327, -2.618034], [2.2270327, -1.25746505E-14, -1.3763819, -2.618034], [1.1135163, -0.809017, 0.26286554, -3.427051], [1.1135163, 0.809017, 0.26286554, -3.427051], [2.2270327, -5.142064E-15, -0.4253254, -2.927051], [-0.4253254, 1.309017, -2.2270327, -2.618034], [0.68819094, 0.5, -2.9152236, -2.118034], [0.68819094, 2.118034, -1.3763819, -2.618034], [1.8017073, 1.309017, -2.0645728, -2.118034], [-0.4253254, 1.309017, 0.26286554, -3.427051], [0.68819094, 0.5, 1.1135163, -3.427051], [1.8017073, 1.309017, 0.4253254, -2.927051], [0.68819094, 2.118034, -0.4253254, -2.927051], [-1.3763819, 2.8532732E-14, -2.2270327, -2.618034], [-0.26286554, 0.809017, -2.9152236, -2.118034], [-1.8017073, 1.309017, -1.3763819, -2.618034], [-0.68819094, 2.118034, -2.0645728, -2.118034], [1.5388417, 2.118034, 1.6542323E-14, -2.618034], [-2.0816682E-15, 2.618034, 1.4904744E-14, -2.618034], [1.5388417, 2.118034, -1.5388417, -2.118034], [-3.1086245E-15, 2.618034, -1.5388417, -2.118034], [-1.3763819, 3.2140957E-14, 0.26286554, -3.427051], [-0.26286554, 0.809017, 1.1135163, -3.427051], [-0.68819094, 2.118034, 0.4253254, -2.927051], [-1.8017073, 1.309017, -0.4253254, -2.927051], [-0.8506508, -4.3132165E-14, -2.9152236, -2.118034], [-0.4253254, -1.309017, -2.2270327, -2.618034], [-2.2270327, -3.5305092E-14, -2.0645728, -2.118034], [-1.8017073, -1.309017, -1.3763819, -2.618034], [-0.8506508, -2.93654E-14, 1.1135163, -3.427051], [-0.4253254, -1.309017, 0.26286554, -3.427051], [-2.2270327, -1.8388069E-14, 0.4253254, -2.927051], [-1.8017073, -1.309017, -0.4253254, -2.927051], [-1.5388417, 2.118034, -1.5388417, -2.118034], [-1.5388417, 2.118034, 2.4202862E-14, -2.618034], [-2.4898982, 0.809017, 2.0594637E-14, -2.618034], [-2.4898982, 0.809017, -1.5388417, -2.118034], [-0.26286554, -0.809017, -2.9152236, -2.118034], [0.68819094, -0.5, -2.9152236, -2.118034], [-0.68819094, -2.118034, -2.0645728, -2.118034], [0.68819094, -2.118034, -1.3763819, -2.618034], [1.8017073, -1.309017, -2.0645728, -2.118034], [2.4898982, 0.809017, 3.230749E-14, -2.618034], [2.4898982, 0.809017, -1.5388417, -2.118034], [2.4898982, -0.809017, 2.8588243E-14, -2.618034], [2.4898982, -0.809017, -1.5388417, -2.118034], [-0.26286554, -0.809017, 1.1135163, -3.427051], [0.68819094, -0.5, 1.1135163, -3.427051], [-0.68819094, -2.118034, 0.4253254, -2.927051], [1.8017073, -1.309017, 0.4253254, -2.927051], [0.68819094, -2.118034, -0.4253254, -2.927051], [1.5388417, -2.118034, 1.8290924E-14, -2.618034], [-1.4099832E-14, -2.618034, 2.0206059E-14, -2.618034], [-1.254552E-14, -2.618034, -1.5388417, -2.118034], [1.5388417, -2.118034, -1.5388417, -2.118034], [-1.5388417, -2.118034, 1.6708857E-14, -2.618034], [-2.4898982, -0.809017, 1.5099033E-14, -2.618034], [-2.4898982, -0.809017, -1.5388417, -2.118034], [-1.5388417, -2.118034, -1.5388417, -2.118034], [-0.4253254, -1.309017, 1.8017073, -2.927051], [1.1135163, -0.809017, 1.8017073, -2.927051], [-1.3763819, -1.25746505E-14, 1.8017073, -2.927051], [-0.4253254, 1.309017, 1.8017073, -2.927051], [1.1135163, 0.809017, 1.8017073, -2.927051], [2.652358, 1.309017, -0.68819094, -2.118034], [2.9152236, 0.5, 0.68819094, -2.118034], [2.0645728, 2.118034, -0.68819094, -2.118034], [1.3763819, 2.618034, 0.68819094, -2.118034], [1.8017073, 1.309017, 1.3763819, -2.618034], [-1.3763819, 2.618034, -0.68819094, -2.118034], [-0.4253254, 2.927051, -0.68819094, -2.118034], [-2.0645728, 2.118034, 0.68819094, -2.118034], [0.4253254, 2.927051, 0.68819094, -2.118034], [-0.68819094, 2.118034, 1.3763819, -2.618034], [-3.5527137E-14, 2.618034, 1.5388417, -2.118034], [-1.5388417, 2.118034, 1.5388417, -2.118034], [-1.1135163, 0.809017, 2.2270327, -2.618034], [0.4253254, 1.309017, 2.2270327, -2.618034], [-2.652358, -1.309017, 0.68819094, -2.118034], [-2.9152236, -0.5, -0.68819094, -2.118034], [-2.652358, 1.309017, 0.68819094, -2.118034], [-2.9152236, 0.5, -0.68819094, -2.118034], [-2.2270327, -5.142064E-15, 1.3763819, -2.618034], [1.3763819, -1.8041124E-14, 2.2270327, -2.618034], 
            [2.4898982, 0.809017, 1.5388417, -2.118034], [1.5388417, 2.118034, 1.5388417, -2.118034], [0.26286554, 0.809017, 2.9152236, -2.118034], [0.68819094, 2.118034, 2.0645728, -2.118034], [2.0645728, -2.118034, -0.68819094, -2.118034], [1.3763819, -2.618034, 0.68819094, -2.118034], [2.652358, -1.309017, -0.68819094, -2.118034], [2.9152236, -0.5, 0.68819094, -2.118034], [1.8017073, -1.309017, 1.3763819, -2.618034], [0.4253254, -1.309017, 2.2270327, -2.618034], [1.5388417, -2.118034, 1.5388417, -2.118034], [2.4898982, -0.809017, 1.5388417, -2.118034], [0.8506508, -2.9087843E-14, 2.9152236, -2.118034], [2.2270327, -3.3972825E-14, 2.0645728, -2.118034], [-2.4898982, -0.809017, 1.5388417, -2.118034], [-2.4898982, 0.809017, 1.5388417, -2.118034], [-1.1135163, -0.809017, 2.2270327, -2.618034], [-1.8017073, 1.309017, 2.0645728, -2.118034], [-0.68819094, 0.5, 2.9152236, -2.118034], [-0.68819094, -0.5, 2.9152236, -2.118034], [0.26286554, -0.809017, 2.9152236, -2.118034], [-0.68819094, -2.118034, 1.3763819, -2.618034], [0.68819094, -2.118034, 2.0645728, -2.118034], [-1.8017073, -1.309017, 2.0645728, -2.118034], [-1.3763819, -2.618034, -0.68819094, -2.118034], [-2.0645728, -2.118034, 0.68819094, -2.118034], [-0.4253254, -2.927051, -0.68819094, -2.118034], [0.4253254, -2.927051, 0.68819094, -2.118034], [-1.5388417, -2.118034, 1.5388417, -2.118034], [-7.258083E-15, -2.618034, 1.5388417, -2.118034], [-0.4253254, -1.309017, -3.1780891, -1.309017], [1.1135163, -0.809017, -3.1780891, -1.309017], [-1.3763819, -1.25746505E-14, -3.1780891, -1.309017], [-0.4253254, 1.309017, -3.1780891, -1.309017], [1.1135163, 0.809017, -3.1780891, -1.309017], [3.1780891, 1.309017, -0.4253254, -1.309017], [2.2270327, 2.618034, -0.4253254, -1.309017], [2.9152236, 0.5, -1.8017073, -1.309017], [1.3763819, 2.618034, -1.8017073, -1.309017], [1.8017073, 1.309017, -2.652358, -1.309017], [-1.8017073, 2.927051, -0.4253254, -1.309017], [-0.26286554, 3.427051, -0.4253254, -1.309017], [-2.0645728, 2.118034, -1.8017073, -1.309017], [0.4253254, 2.927051, -1.8017073, -1.309017], [-0.68819094, 2.118034, -2.652358, -1.309017], [-3.7303494E-14, 2.618034, -2.4898982, -0.809017], [-1.5388417, 2.118034, -2.4898982, -0.809017], [-1.1135163, 0.809017, -3.340549, -0.809017], [0.4253254, 1.309017, -3.340549, -0.809017], [-3.340549, -0.809017, -0.4253254, -1.309017], [-3.340549, 0.809017, -0.4253254, -1.309017], [-2.652358, -1.309017, -1.8017073, -1.309017], [-2.652358, 1.309017, -1.8017073, -1.309017], [-2.2270327, -5.142064E-15, -2.652358, -1.309017], [1.3763819, -1.7763568E-14, -3.340549, -0.809017], [2.4898982, 0.809017, -2.4898982, -0.809017], [1.5388417, 2.118034, -2.4898982, -0.809017], [0.26286554, 0.809017, -3.6034145, 2.2146839E-14], [0.68819094, 2.118034, -2.9152236, -0.5], [2.2270327, -2.618034, -0.4253254, -1.309017], [3.1780891, -1.309017, -0.4253254, -1.309017], [1.3763819, -2.618034, -1.8017073, -1.309017], [2.9152236, -0.5, -1.8017073, -1.309017], [1.8017073, -1.309017, -2.652358, -1.309017], [0.4253254, -1.309017, -3.340549, -0.809017], [1.5388417, -2.118034, -2.4898982, -0.809017], [2.4898982, -0.809017, -2.4898982, -0.809017], [0.8506508, -2.9309888E-14, -3.6034145, 2.1733056E-14], [2.2270327, -3.4416914E-14, -2.9152236, -0.5], [-2.4898982, -0.809017, -2.4898982, -0.809017], [-2.4898982, 0.809017, -2.4898982, -0.809017], [-1.1135163, -0.809017, -3.340549, -0.809017], [-1.8017073, 1.309017, -2.9152236, -0.5], [-0.68819094, 0.5, -3.6034145, 2.0687892E-14], [-0.68819094, -0.5, -3.6034145, 2.0872193E-14], [0.26286554, -0.809017, -3.6034145, 2.1538327E-14], [-0.68819094, -2.118034, -2.652358, -1.309017], [0.68819094, -2.118034, -2.9152236, -0.5], [-1.8017073, -1.309017, -2.9152236, -0.5], [-1.8017073, -2.927051, -0.4253254, -1.309017], [-0.26286554, -3.427051, -0.4253254, -1.309017], [-2.0645728, -2.118034, -1.8017073, -1.309017], [0.4253254, -2.927051, -1.8017073, -1.309017], [-1.5388417, -2.118034, -2.4898982, -0.809017], [-7.2303274E-15, -2.618034, -2.4898982, -0.809017], [3.340549, -0.809017, -1.1135163, -0.809017], [2.652358, -1.309017, -2.2270327, 2.9282132E-14], [2.2270327, -9.270362E-15, -2.9152236, 0.5], [3.340549, 0.809017, -1.1135163, -0.809017], [2.652358, 1.309017, -2.2270327, 2.5646152E-14], [2.2270327, -1.7797805E-15, 2.652358, -1.309017], [2.652358, -1.309017, 1.8017073, -1.309017], [2.652358, 1.309017, 1.8017073, -1.309017], [3.340549, -0.809017, 0.4253254, -1.309017], [3.340549, 0.809017, 0.4253254, -1.309017], [0.26286554, 3.427051, -1.1135163, -0.809017], [1.8017073, 2.927051, -1.1135163, -0.809017], [2.0645728, 2.118034, -2.2270327, 2.314815E-14], [-0.4253254, 2.927051, -2.2270327, 2.239875E-14], [0.68819094, 2.118034, -2.9152236, 0.5], 
            [3.1780891, 1.309017, 1.1135163, -0.809017], [3.6034145, 2.1233015E-14, 0.26286554, -0.809017], [2.9152236, 2.118034, -0.26286554, -0.809017], [3.6034145, 2.1260771E-14, -0.68819094, -0.5], [3.1780891, 1.309017, -1.3763819, 2.7200464E-14], [2.9152236, 2.118034, 0.68819094, -0.5], [1.8017073, 2.927051, 0.4253254, -1.309017], [2.9152236, 2.118034, -0.8506508, 2.0372593E-14], [2.2270327, 2.618034, -1.3763819, 1.8762769E-14], [1.1135163, 3.427051, -0.68819094, -0.5], [0.68819094, 2.118034, 2.652358, -1.309017], [2.0645728, 2.118034, 1.8017073, -1.309017], [-0.4253254, 2.927051, 1.8017073, -1.309017], [2.2270327, 2.618034, 1.1135163, -0.809017], [0.26286554, 3.427051, 0.4253254, -1.309017], [1.1135163, 3.427051, 0.26286554, -0.809017], [-2.9152236, 0.5, -2.2270327, 2.5451863E-14], [-3.1780891, 1.309017, -1.1135163, -0.809017], [-2.2270327, 2.618034, -1.1135163, -0.809017], [-1.8017073, 1.309017, -2.9152236, 0.5], [-1.3763819, 2.618034, -2.2270327, 2.3259172E-14], [1.1135163, 3.427051, -0.68819094, 0.5], [1.1135163, 3.427051, 0.8506508, 3.3972825E-14], [-0.26286554, 3.427051, 1.1135163, -0.809017], [-1.1135163, 3.427051, -0.26286554, -0.809017], [-0.26286554, 3.427051, -1.3763819, 3.1086245E-14], [-2.2270327, 2.618034, 0.4253254, -1.309017], [-1.1135163, 3.427051, 0.68819094, -0.5], [-1.8017073, 2.927051, -1.3763819, 1.7263968E-14], [-1.1135163, 3.427051, -0.8506508, 1.7957857E-14], [-2.9152236, 2.118034, -0.68819094, -0.5], [-2.9152236, 0.5, 1.8017073, -1.309017], [-1.8017073, 1.309017, 2.652358, -1.309017], [-1.3763819, 2.618034, 1.8017073, -1.309017], [-3.1780891, 1.309017, 0.4253254, -1.309017], [-2.9152236, 2.118034, 0.26286554, -0.809017], [-1.8017073, 2.927051, 1.1135163, -0.809017], [-1.8017073, -1.309017, -2.9152236, 0.5], [-1.3763819, -2.618034, -2.2270327, 3.18634E-14], [-2.2270327, -2.618034, -1.1135163, -0.809017], [-2.9152236, -0.5, -2.2270327, 2.872702E-14], [-3.1780891, -1.309017, -1.1135163, -0.809017], [-2.9152236, -0.5, 1.8017073, -1.309017], [-1.8017073, -1.309017, 2.652358, -1.309017], [-1.3763819, -2.618034, 1.8017073, -1.309017], [-2.2270327, -2.618034, 0.4253254, -1.309017], [-3.1780891, -1.309017, 0.4253254, -1.309017], [-3.6034145, 2.220446E-16, -0.26286554, -0.809017], [-3.340549, -0.809017, 1.1135163, -0.809017], [-3.340549, -0.809017, -1.3763819, 2.6673108E-14], [-2.9152236, -2.118034, -0.68819094, -0.5], [-2.9152236, -2.118034, 0.26286554, -0.809017], [-2.9152236, 2.118034, -0.68819094, 0.5], [-2.9152236, 2.118034, 0.8506508, 3.3861802E-14], [-3.340549, 0.809017, 1.1135163, -0.809017], [-3.6034145, 7.4940054E-16, 0.68819094, -0.5], [-3.6034145, 1.2767565E-15, -0.8506508, 3.0198066E-14], [-3.340549, 0.809017, -1.3763819, 2.9642955E-14], [-0.4253254, -2.927051, -2.2270327, 3.2890357E-14], [0.68819094, -2.118034, -2.9152236, 0.5], [2.0645728, -2.118034, -2.2270327, 3.1891156E-14], [0.26286554, -3.427051, -1.1135163, -0.809017], [1.8017073, -2.927051, -1.1135163, -0.809017], [3.1780891, -1.309017, 1.1135163, -0.809017], [3.6034145, -1.64313E-14, 0.8506508, 3.0753178E-14], [3.6034145, -1.5418222E-14, -0.68819094, 0.5], [3.1780891, -1.309017, -1.3763819, 2.6201263E-14], [2.9152236, -2.118034, -0.26286554, -0.809017], [1.8017073, -2.927051, 0.4253254, -1.309017], [2.9152236, -2.118034, 0.68819094, -0.5], [1.1135163, -3.427051, -0.68819094, -0.5], [2.2270327, -2.618034, -1.3763819, 1.687539E-14], [2.9152236, -2.118034, -0.8506508, 1.7402746E-14], [-0.4253254, -2.927051, 1.8017073, -1.309017], [0.68819094, -2.118034, 2.652358, -1.309017], [2.0645728, -2.118034, 1.8017073, -1.309017], [2.2270327, -2.618034, 1.1135163, -0.809017], [1.1135163, -3.427051, 0.26286554, -0.809017], [0.26286554, -3.427051, 0.4253254, -1.309017], [-1.1135163, -3.427051, -0.26286554, -0.809017], [-0.26286554, -3.427051, 1.1135163, -0.809017], [-0.26286554, -3.427051, -1.3763819, 2.339795E-14], [1.1135163, -3.427051, 0.8506508, 2.6229019E-14], [1.1135163, -3.427051, -0.68819094, 0.5], [-2.9152236, -2.118034, 0.8506508, 3.175238E-14], [-2.9152236, -2.118034, -0.68819094, 0.5], [-1.8017073, -2.927051, 1.1135163, -0.809017], [-1.8017073, -2.927051, -1.3763819, 2.6867397E-14], [-1.1135163, -3.427051, 0.68819094, -0.5], [-1.1135163, -3.427051, -0.8506508, 2.8532732E-14], [-1.1135163, -0.809017, 3.1780891, -1.309017], [0.4253254, -1.309017, 3.1780891, -1.309017], [1.3763819, -9.270362E-15, 3.1780891, -1.309017], [-1.1135163, 0.809017, 3.1780891, -1.309017], [0.4253254, 1.309017, 3.1780891, -1.309017], [1.8017073, 2.927051, 1.3763819, 3.3861802E-14], [2.9152236, 2.118034, 0.68819094, 0.5], [3.340549, 0.809017, 1.3763819, 3.1696867E-14], [2.4898982, 0.809017, 2.4898982, -0.809017], [1.5388417, 2.118034, 2.4898982, -0.809017], 
            [-6.078471E-15, 2.618034, 2.4898982, -0.809017], [1.3763819, 2.618034, 2.2270327, 2.842171E-14], [-0.4253254, 1.309017, 3.340549, -0.809017], [1.1135163, 0.809017, 3.340549, -0.809017], [1.8017073, 1.309017, 2.9152236, -0.5], [-2.2270327, 2.618034, 1.3763819, 3.4583447E-14], [-1.1135163, 3.427051, 0.68819094, 0.5], [0.26286554, 3.427051, 1.3763819, 3.3334446E-14], [0.4253254, 2.927051, 2.2270327, 3.26128E-14], [-0.68819094, 2.118034, 2.9152236, -0.5], [-1.5388417, 2.118034, 2.4898982, -0.809017], [-2.4898982, 0.809017, 2.4898982, -0.809017], [-2.0645728, 2.118034, 2.2270327, 3.1530334E-14], [-1.3763819, 3.5665915E-15, 3.340549, -0.809017], [-0.68819094, 2.118034, 2.9152236, 0.5], [-0.26286554, 0.809017, 3.6034145, 2.553513E-14], [-3.6034145, -1.7797805E-15, 0.68819094, 0.5], [-3.1780891, -1.309017, 1.3763819, 3.16136E-14], [-3.1780891, 1.309017, 1.3763819, 3.13638E-14], [-2.4898982, -0.809017, 2.4898982, -0.809017], [-2.652358, 1.309017, 2.2270327, 3.225198E-14], [-2.2270327, 2.6062754E-16, 2.9152236, -0.5], [2.4898982, -0.809017, 2.4898982, -0.809017], [2.9152236, 0.5, 2.2270327, 2.88658E-14], [1.1135163, -0.809017, 3.340549, -0.809017], [1.8017073, 1.309017, 2.9152236, 0.5], [0.68819094, 0.5, 3.6034145, 2.6756375E-14], [1.8017073, -2.927051, 1.3763819, 3.3917313E-14], [2.9152236, -2.118034, 0.68819094, 0.5], [3.340549, -0.809017, 1.3763819, 3.2224223E-14], [1.5388417, -2.118034, 2.4898982, -0.809017], [1.8017073, -1.309017, 2.9152236, -0.5], [2.9152236, -0.5, 2.2270327, 3.2168712E-14], [1.3763819, -2.618034, 2.2270327, 2.9642955E-14], [-3.1918912E-15, -2.618034, 2.4898982, -0.809017], [1.8017073, -1.309017, 2.9152236, 0.5], [-0.4253254, -1.309017, 3.340549, -0.809017], [0.68819094, -0.5, 3.6034145, 2.8199665E-14], [-2.652358, -1.309017, 2.2270327, 3.1197267E-14], [-1.5388417, -2.118034, 2.4898982, -0.809017], [-2.2270327, -1.1726731E-14, 2.9152236, 0.5], [-0.68819094, -2.118034, 2.9152236, -0.5], [-0.8506508, -1.110223E-14, 3.6034145, 2.842171E-14], [-0.26286554, -0.809017, 3.6034145, 2.9198866E-14], [-1.1135163, -3.427051, 0.68819094, 0.5], [0.26286554, -3.427051, 1.3763819, 3.355649E-14], [-2.2270327, -2.618034, 1.3763819, 3.350098E-14], [0.4253254, -2.927051, 2.2270327, 3.2085445E-14], [-2.0645728, -2.118034, 2.2270327, 3.2085445E-14], [-0.68819094, -2.118034, 2.9152236, 0.5], [-1.1135163, -0.809017, -3.340549, 0.809017], [0.4253254, -1.309017, -3.340549, 0.809017], [1.3763819, -9.270362E-15, -3.340549, 0.809017], [-1.1135163, 0.809017, -3.340549, 0.809017], [0.4253254, 1.309017, -3.340549, 0.809017], [1.8017073, 2.927051, -1.1135163, 0.809017], [2.9152236, 2.118034, -0.26286554, 0.809017], [3.340549, 0.809017, -1.1135163, 0.809017], [2.4898982, 0.809017, -2.4898982, 0.809017], [1.5388417, 2.118034, -2.4898982, 0.809017], [-6.133982E-15, 2.618034, -2.4898982, 0.809017], [1.3763819, 2.618034, -1.8017073, 1.309017], [-0.4253254, 1.309017, -3.1780891, 1.309017], [1.1135163, 0.809017, -3.1780891, 1.309017], [1.8017073, 1.309017, -2.652358, 1.309017], [-2.2270327, 2.618034, -1.1135163, 0.809017], [-1.1135163, 3.427051, -0.26286554, 0.809017], [0.26286554, 3.427051, -1.1135163, 0.809017], [0.4253254, 2.927051, -1.8017073, 1.309017], [-0.68819094, 2.118034, -2.652358, 1.309017], [-1.5388417, 2.118034, -2.4898982, 0.809017], [-2.4898982, 0.809017, -2.4898982, 0.809017], [-2.0645728, 2.118034, -1.8017073, 1.309017], [-1.3763819, 3.8302694E-15, -3.1780891, 1.309017], [-0.68819094, 2.118034, -2.0645728, 2.118034], [-0.26286554, 0.809017, -2.9152236, 2.118034], [-3.6034145, -1.7797805E-15, -0.26286554, 0.809017], [-3.1780891, -1.309017, -1.1135163, 0.809017], [-3.1780891, 1.309017, -1.1135163, 0.809017], [-2.4898982, -0.809017, -2.4898982, 0.809017], [-2.652358, 1.309017, -1.8017073, 1.309017], [-2.2270327, 2.6062754E-16, -2.652358, 1.309017], [2.4898982, -0.809017, -2.4898982, 0.809017], [2.9152236, 0.5, -1.8017073, 1.309017], [1.1135163, -0.809017, -3.1780891, 1.309017], [1.8017073, 1.309017, -2.0645728, 2.118034], [0.68819094, 0.5, -2.9152236, 2.118034], [1.8017073, -2.927051, -1.1135163, 0.809017], [2.9152236, -2.118034, -0.26286554, 0.809017], [3.340549, -0.809017, -1.1135163, 0.809017], [1.5388417, -2.118034, -2.4898982, 0.809017], [1.8017073, -1.309017, -2.652358, 1.309017], [2.9152236, -0.5, -1.8017073, 1.309017], [1.3763819, -2.618034, -1.8017073, 1.309017], [-3.3029135E-15, -2.618034, -2.4898982, 0.809017], [1.8017073, -1.309017, -2.0645728, 2.118034], [-0.4253254, -1.309017, -3.1780891, 1.309017], [0.68819094, -0.5, -2.9152236, 2.118034], [-2.652358, -1.309017, -1.8017073, 1.309017], [-1.5388417, -2.118034, -2.4898982, 0.809017], 
            [-2.2270327, -1.1726731E-14, -2.0645728, 2.118034], [-0.68819094, -2.118034, -2.652358, 1.309017], [-0.8506508, -1.110223E-14, -2.9152236, 2.118034], [-0.26286554, -0.809017, -2.9152236, 2.118034], [-1.1135163, -3.427051, -0.26286554, 0.809017], [0.26286554, -3.427051, -1.1135163, 0.809017], [-2.2270327, -2.618034, -1.1135163, 0.809017], [0.4253254, -2.927051, -1.8017073, 1.309017], [-2.0645728, -2.118034, -1.8017073, 1.309017], [-0.68819094, -2.118034, -2.0645728, 2.118034], [3.1780891, -1.309017, -0.4253254, 1.309017], [2.4898982, -0.809017, -1.5388417, 2.118034], [3.6034145, -3.475548E-15, 0.26286554, 0.809017], [3.1780891, 1.309017, -0.4253254, 1.309017], [2.4898982, 0.809017, -1.5388417, 2.118034], [2.4898982, -0.809017, 2.4898982, 0.809017], [2.4898982, 0.809017, 2.4898982, 0.809017], [3.1780891, -1.309017, 1.1135163, 0.809017], [3.1780891, 1.309017, 1.1135163, 0.809017], [3.340549, -0.809017, 0.4253254, 1.309017], [3.340549, 0.809017, 0.4253254, 1.309017], [1.1135163, 3.427051, 0.26286554, 0.809017], [2.2270327, 2.618034, -0.4253254, 1.309017], [-0.26286554, 3.427051, -0.4253254, 1.309017], [6.179085E-15, 2.618034, -1.5388417, 2.118034], [1.5388417, 2.118034, -1.5388417, 2.118034], [2.652358, 1.309017, 1.8017073, 1.309017], [2.9152236, 0.5, 0.68819094, 2.118034], [2.2270327, 2.618034, 1.1135163, 0.809017], [2.652358, 1.309017, -0.68819094, 2.118034], [1.8017073, 2.927051, 0.4253254, 1.309017], [2.0645728, 2.118034, -0.68819094, 2.118034], [3.524958E-15, 2.618034, 2.4898982, 0.809017], [1.5388417, 2.118034, 2.4898982, 0.809017], [-0.26286554, 3.427051, 1.1135163, 0.809017], [2.0645728, 2.118034, 1.8017073, 1.309017], [1.3763819, 2.618034, 0.68819094, 2.118034], [0.26286554, 3.427051, 0.4253254, 1.309017], [-3.340549, 0.809017, -0.4253254, 1.309017], [-2.9152236, 2.118034, 0.26286554, 0.809017], [-2.4898982, 0.809017, -1.5388417, 2.118034], [-1.5388417, 2.118034, -1.5388417, 2.118034], [-1.8017073, 2.927051, -0.4253254, 1.309017], [-0.4253254, 2.927051, 1.8017073, 1.309017], [0.4253254, 2.927051, 0.68819094, 2.118034], [-1.8017073, 2.927051, 1.1135163, 0.809017], [-0.4253254, 2.927051, -0.68819094, 2.118034], [-2.2270327, 2.618034, 0.4253254, 1.309017], [-1.3763819, 2.618034, -0.68819094, 2.118034], [-2.4898982, 0.809017, 2.4898982, 0.809017], [-1.5388417, 2.118034, 2.4898982, 0.809017], [-3.340549, 0.809017, 1.1135163, 0.809017], [-1.3763819, 2.618034, 1.8017073, 1.309017], [-3.1780891, 1.309017, 0.4253254, 1.309017], [-2.0645728, 2.118034, 0.68819094, 2.118034], [-1.5388417, -2.118034, -1.5388417, 2.118034], [-1.8017073, -2.927051, -0.4253254, 1.309017], [-2.4898982, -0.809017, -1.5388417, 2.118034], [-3.340549, -0.809017, -0.4253254, 1.309017], [-2.9152236, -2.118034, 0.26286554, 0.809017], [-1.5388417, -2.118034, 2.4898982, 0.809017], [-2.4898982, -0.809017, 2.4898982, 0.809017], [-1.8017073, -2.927051, 1.1135163, 0.809017], [-3.340549, -0.809017, 1.1135163, 0.809017], [-2.2270327, -2.618034, 0.4253254, 1.309017], [-3.1780891, -1.309017, 0.4253254, 1.309017], [-2.652358, 1.309017, 0.68819094, 2.118034], [-2.9152236, 0.5, 1.8017073, 1.309017], [-2.9152236, 0.5, -0.68819094, 2.118034], [-2.9152236, -0.5, 1.8017073, 1.309017], [-2.9152236, -0.5, -0.68819094, 2.118034], [-2.652358, -1.309017, 0.68819094, 2.118034], [1.599415E-15, -2.618034, -1.5388417, 2.118034], [1.5388417, -2.118034, -1.5388417, 2.118034], [-0.26286554, -3.427051, -0.4253254, 1.309017], [1.1135163, -3.427051, 0.26286554, 0.809017], [2.2270327, -2.618034, -0.4253254, 1.309017], [2.9152236, -0.5, 0.68819094, 2.118034], [2.652358, -1.309017, 1.8017073, 1.309017], [2.652358, -1.309017, -0.68819094, 2.118034], [2.2270327, -2.618034, 1.1135163, 0.809017], [2.0645728, -2.118034, -0.68819094, 2.118034], [1.8017073, -2.927051, 0.4253254, 1.309017], [1.1379786E-15, -2.618034, 2.4898982, 0.809017], [1.5388417, -2.118034, 2.4898982, 0.809017], [-0.26286554, -3.427051, 1.1135163, 0.809017], [2.0645728, -2.118034, 1.8017073, 1.309017], [0.26286554, -3.427051, 0.4253254, 1.309017], [1.3763819, -2.618034, 0.68819094, 2.118034], [-2.0645728, -2.118034, 0.68819094, 2.118034], [-1.3763819, -2.618034, 1.8017073, 1.309017], [-1.3763819, -2.618034, -0.68819094, 2.118034], [-0.4253254, -2.927051, 1.8017073, 1.309017], [-0.4253254, -2.927051, -0.68819094, 2.118034], [0.4253254, -2.927051, 0.68819094, 2.118034], [-0.4253254, -1.309017, 3.340549, 0.809017], [1.1135163, -0.809017, 3.340549, 0.809017], [-1.3763819, -3.475548E-15, 3.340549, 0.809017], [-0.4253254, 1.309017, 3.340549, 0.809017], [1.1135163, 0.809017, 3.340549, 0.809017], 
            [2.4898982, 0.809017, 1.5388417, 2.118034], [1.5388417, 2.118034, 1.5388417, 2.118034], [2.2270327, 5.2735594E-15, 2.652358, 1.309017], [0.68819094, 2.118034, 2.652358, 1.309017], [1.3763819, 3.7747583E-15, 3.1780891, 1.309017], [0.4253254, 1.309017, 3.1780891, 1.309017], [-1.5388417, 2.118034, 1.5388417, 2.118034], [-1.5820678E-15, 2.618034, 1.5388417, 2.118034], [-1.8017073, 1.309017, 2.652358, 1.309017], [0.68819094, 2.118034, 2.0645728, 2.118034], [-1.1135163, 0.809017, 3.1780891, 1.309017], [0.26286554, 0.809017, 2.9152236, 2.118034], [-2.4898982, -0.809017, 1.5388417, 2.118034], [-2.4898982, 0.809017, 1.5388417, 2.118034], [-1.8017073, -1.309017, 2.652358, 1.309017], [-1.8017073, 1.309017, 2.0645728, 2.118034], [-1.1135163, -0.809017, 3.1780891, 1.309017], [-0.68819094, 0.5, 2.9152236, 2.118034], [1.5388417, -2.118034, 1.5388417, 2.118034], [2.4898982, -0.809017, 1.5388417, 2.118034], [0.68819094, -2.118034, 2.652358, 1.309017], [2.2270327, -3.8857806E-15, 2.0645728, 2.118034], [0.4253254, -1.309017, 3.1780891, 1.309017], [0.8506508, -8.881784E-16, 2.9152236, 2.118034], [-1.5388417, -2.118034, 1.5388417, 2.118034], [-4.1633363E-16, -2.618034, 1.5388417, 2.118034], [-1.8017073, -1.309017, 2.0645728, 2.118034], [0.68819094, -2.118034, 2.0645728, 2.118034], [0.26286554, -0.809017, 2.9152236, 2.118034], [-0.68819094, -0.5, 2.9152236, 2.118034], [-0.4253254, -1.309017, -2.2270327, 2.618034], [1.1135163, -0.809017, -2.2270327, 2.618034], [-1.3763819, -3.475548E-15, -2.2270327, 2.618034], [-0.4253254, 1.309017, -2.2270327, 2.618034], [1.1135163, 0.809017, -2.2270327, 2.618034], [2.4898982, 0.809017, 1.110223E-15, 2.618034], [1.5388417, 2.118034, 2.220446E-15, 2.618034], [2.2270327, 5.287437E-15, -1.3763819, 2.618034], [0.68819094, 2.118034, -1.3763819, 2.618034], [1.3763819, 3.8302694E-15, -1.8017073, 2.927051], [0.4253254, 1.309017, -1.8017073, 2.927051], [-1.5388417, 2.118034, 1.9984014E-15, 2.618034], [-1.5820678E-15, 2.618034, 1.6653345E-15, 2.618034], [-1.8017073, 1.309017, -1.3763819, 2.618034], [0.68819094, 2.118034, -0.4253254, 2.927051], [-1.1135163, 0.809017, -1.8017073, 2.927051], [0.26286554, 0.809017, -1.1135163, 3.427051], [-2.4898982, -0.809017, 2.1094237E-15, 2.618034], [-2.4898982, 0.809017, 1.6653345E-15, 2.618034], [-1.8017073, -1.309017, -1.3763819, 2.618034], [-1.8017073, 1.309017, -0.4253254, 2.927051], [-1.1135163, -0.809017, -1.8017073, 2.927051], [-0.68819094, 0.5, -1.1135163, 3.427051], [1.5388417, -2.118034, 1.9984014E-15, 2.618034], [2.4898982, -0.809017, 1.110223E-15, 2.618034], [0.68819094, -2.118034, -1.3763819, 2.618034], [2.2270327, -3.871903E-15, -0.4253254, 2.927051], [0.4253254, -1.309017, -1.8017073, 2.927051], [0.8506508, -9.992007E-16, -1.1135163, 3.427051], [-1.5388417, -2.118034, 1.5543122E-15, 2.618034], [-4.1633363E-16, -2.618034, 1.8873791E-15, 2.618034], [-1.8017073, -1.309017, -0.4253254, 2.927051], [0.68819094, -2.118034, -0.4253254, 2.927051], [0.26286554, -0.809017, -1.1135163, 3.427051], [-0.68819094, -0.5, -1.1135163, 3.427051], [1.3763819, 1.6310964E-16, 2.2270327, 2.618034], [1.8017073, -1.309017, 1.3763819, 2.618034], [1.8017073, 1.309017, 1.3763819, 2.618034], [1.8017073, -1.309017, 0.4253254, 2.927051], [1.3763819, -1.4988011E-15, -0.26286554, 3.427051], [1.8017073, 1.309017, 0.4253254, 2.927051], [0.4253254, 1.309017, 2.2270327, 2.618034], [1.1135163, 0.809017, 1.8017073, 2.927051], [-0.68819094, 2.118034, 1.3763819, 2.618034], [1.1135163, 0.809017, 0.26286554, 3.427051], [-0.68819094, 2.118034, 0.4253254, 2.927051], [0.4253254, 1.309017, -0.26286554, 3.427051], [-2.2270327, 1.2906343E-15, 1.3763819, 2.618034], [-1.1135163, 0.809017, 2.2270327, 2.618034], [-0.4253254, 1.309017, 0.26286554, 3.427051], [-0.4253254, 1.309017, 1.8017073, 2.927051], [-2.2270327, 1.5543122E-15, 0.4253254, 2.927051], [-1.1135163, 0.809017, -0.26286554, 3.427051], [-1.3763819, -1.3877788E-16, 0.26286554, 3.427051], [-1.3763819, -1.110223E-16, 1.8017073, 2.927051], [-1.1135163, -0.809017, 2.2270327, 2.618034], [-0.68819094, -2.118034, 1.3763819, 2.618034], [-1.1135163, -0.809017, -0.26286554, 3.427051], [-0.68819094, -2.118034, 0.4253254, 2.927051], [-0.4253254, -1.309017, 1.8017073, 2.927051], [-0.4253254, -1.309017, 0.26286554, 3.427051], [0.4253254, -1.309017, 2.2270327, 2.618034], [1.1135163, -0.809017, 1.8017073, 2.927051], [1.1135163, -0.809017, 0.26286554, 3.427051], [0.4253254, -1.309017, -0.26286554, 3.427051], [-0.26286554, -0.809017, 1.1135163, 3.427051], [0.68819094, -0.5, 1.1135163, 3.427051], [-0.8506508, 1.6310964E-16, 1.1135163, 3.427051], [-0.26286554, 0.809017, 1.1135163, 3.427051], [0.68819094, 0.5, 1.1135163, 3.427051]
        ]
        const edges = [
            [0, 1], [1, 2], [3, 1], [4, 1], [2, 5], [6, 2], [7, 2], [0, 8], [9, 0], [0, 10], [11, 5], [9, 12], [5, 9], [9, 13], [14, 5], [10, 15], [16, 10], [17, 10], [8, 18], [19, 8], [20, 8], [4, 16], [21, 4], [16, 22], [23, 4], [16, 24], [3, 19], [25, 3], [19, 26], [19, 27], [3, 28], [29, 7], [21, 30], [7, 21], [7, 31], [32, 21], [28, 33], [34, 28], [23, 35], [28, 23], [23, 36], [37, 6], [25, 38], [6, 25], [25, 39], [6, 40], [29, 41], [14, 29], [42, 14], [43, 29], [44, 14], [37, 45], [11, 37], [46, 11], [37, 47], [11, 48], [31, 49], [40, 31], [50, 40], [51, 40], [52, 31], [42, 53], [13, 42], [15, 13], [54, 15], [55, 42], [56, 13], [57, 15], [20, 58], [17, 20], [59, 17], [20, 60], [17, 61], [46, 62], [12, 46], [18, 12], [63, 18], [46, 64], [65, 18], [66, 12], [67, 66], [66, 68], [56, 69], [66, 56], [70, 56], [71, 48], [48, 72], [44, 73], [48, 44], [74, 44], [62, 63], [45, 62], [38, 45], [26, 38], [63, 26], [75, 62], [63, 76], [77, 45], [78, 38], [79, 26], 
            [58, 80], [81, 58], [33, 82], [27, 33], [58, 27], [33, 83], [27, 84], [50, 85], [39, 50], [34, 39], [86, 34], [50, 87], [88, 34], [89, 39], [90, 89], [89, 91], [78, 92], [89, 78], [93, 78], [72, 94], [95, 72], [96, 51], [51, 97], [47, 72], [51, 47], [98, 47], [99, 79], [84, 100], [79, 84], [84, 101], [93, 102], [79, 93], [103, 93], [67, 104], [105, 67], [67, 65], [60, 106], [65, 60], [60, 107], [65, 108], [76, 108], [109, 76], [108, 110], [108, 111], [99, 112], [76, 99], [113, 99], [98, 114], [115, 98], [77, 116], [98, 77], [92, 117], [77, 92], [118, 92], [75, 109], [116, 75], [119, 116], [109, 120], [121, 75], [109, 122], [123, 116], [71, 124], [125, 71], [64, 68], [71, 64], [68, 126], [68, 127], [121, 128], [64, 121], [129, 121], [53, 54], [41, 53], [30, 41], [22, 30], [54, 22], [130, 53], [54, 131], [132, 41], [133, 30], [134, 22], [80, 135], [82, 80], [136, 82], [59, 80], [137, 59], [35, 82], [24, 35], [59, 24], [35, 138], [24, 139], [85, 86], [140, 85], [86, 141], [49, 85], [32, 49], [36, 32], [86, 36], [49, 142], [143, 36], [144, 32], 
            [145, 144], [144, 146], [133, 147], [144, 133], [148, 133], [149, 95], [97, 150], [95, 97], [73, 151], [95, 73], [152, 52], [52, 97], [43, 73], [52, 43], [153, 43], [154, 134], [139, 155], [134, 139], [139, 156], [148, 157], [134, 148], [158, 148], [104, 159], [106, 104], [160, 106], [70, 104], [161, 70], [70, 57], [61, 106], [57, 61], [61, 162], [57, 163], [131, 163], [164, 131], [163, 165], [163, 166], [154, 167], [131, 154], [168, 154], [153, 169], [170, 153], [132, 171], [153, 132], [147, 172], [132, 147], [173, 147], [130, 164], [171, 130], [174, 171], [164, 175], [176, 130], [164, 177], [178, 171], [124, 179], [126, 124], [180, 126], [74, 124], [181, 74], [55, 69], [74, 55], [69, 126], [69, 182], [176, 183], [55, 176], [184, 176], [185, 162], [166, 186], [162, 166], [168, 187], [166, 168], [137, 162], [188, 137], [155, 137], [189, 155], [168, 155], [113, 190], [111, 113], [191, 111], [113, 100], [100, 192], [111, 107], [107, 193], [81, 107], [100, 81], [194, 81], [195, 143], [138, 196], [143, 138], [156, 197], [138, 156], [145, 143], [198, 145], [158, 145], [199, 158], [156, 158], [194, 200], [201, 194], [135, 194], [202, 135], [188, 203], 
            [135, 188], [188, 204], [202, 205], [136, 202], [206, 136], [207, 202], [196, 136], [208, 196], [196, 209], [103, 210], [101, 103], [211, 101], [90, 212], [103, 90], [90, 88], [83, 101], [88, 83], [206, 213], [83, 206], [214, 88], [206, 215], [216, 170], [152, 217], [170, 152], [142, 218], [152, 142], [172, 170], [219, 172], [146, 172], [220, 146], [142, 146], [209, 215], [221, 209], [215, 222], [214, 223], [215, 214], [141, 214], [224, 141], [195, 225], [209, 195], [141, 195], [140, 224], [226, 140], [224, 227], [218, 140], [228, 218], [224, 229], [218, 230], [115, 231], [117, 115], [232, 117], [91, 117], [233, 91], [96, 115], [234, 96], [87, 91], [96, 87], [226, 235], [236, 226], [87, 226], [237, 178], [183, 238], [178, 183], [181, 239], [183, 181], [169, 178], [240, 169], [151, 169], [241, 151], [181, 151], [114, 123], [242, 114], [123, 243], [128, 244], [123, 128], [125, 128], [245, 125], [94, 246], [114, 94], [125, 94], [149, 247], [246, 149], [248, 246], [241, 149], [249, 241], [241, 250], [251, 246], [252, 230], [235, 253], [230, 235], [234, 254], [235, 234], [247, 255], [256, 247], [217, 257], [230, 217], [150, 217], [234, 150], [247, 150], [258, 184], 
            [177, 259], [184, 177], [165, 260], [177, 165], [182, 184], [261, 182], [161, 182], [262, 161], [165, 161], [193, 201], [263, 193], [201, 264], [203, 265], [201, 203], [185, 203], [266, 185], [160, 267], [193, 160], [185, 160], [159, 268], [267, 159], [269, 267], [262, 159], [270, 262], [262, 271], [272, 267], [273, 129], [122, 274], [129, 122], [110, 275], [122, 110], [268, 276], [277, 268], [127, 278], [129, 127], [105, 127], [110, 105], [268, 105], [180, 279], [278, 180], [280, 278], [261, 180], [281, 261], [277, 278], [270, 277], [261, 270], [277, 282], [270, 283], [251, 284], [250, 251], [285, 250], [251, 245], [245, 286], [250, 239], [239, 287], [179, 239], [245, 179], [279, 179], [288, 279], [289, 279], [290, 119], [120, 291], [119, 120], [112, 292], [120, 112], [118, 119], [293, 118], [102, 118], [294, 102], [112, 102], [213, 205], [295, 213], [205, 296], [200, 297], [205, 200], [192, 200], [298, 192], [211, 299], [213, 211], [192, 211], [210, 300], [299, 210], [301, 299], [294, 210], [302, 294], [294, 303], [304, 299], [305, 236], [227, 306], [236, 227], [223, 307], [227, 223], [300, 308], [309, 300], [233, 310], [236, 233], [212, 233], [223, 212], [300, 212], [232, 311], 
            [310, 232], [312, 310], [293, 232], [313, 293], [309, 310], [302, 309], [293, 302], [309, 314], [302, 315], [255, 316], [248, 255], [317, 248], [255, 254], [254, 318], [248, 242], [242, 319], [231, 242], [254, 231], [311, 231], [320, 311], [321, 311], [190, 298], [322, 190], [298, 323], [292, 190], [303, 292], [304, 303], [298, 304], [292, 324], [325, 304], [326, 303], [276, 327], [269, 276], [328, 269], [263, 269], [329, 263], [275, 276], [330, 275], [191, 263], [275, 191], [322, 331], [332, 322], [191, 322], [330, 333], [274, 330], [334, 274], [331, 330], [335, 331], [291, 274], [324, 291], [331, 324], [291, 336], [324, 337], [319, 243], [338, 319], [243, 339], [321, 319], [313, 321], [290, 313], [243, 290], [321, 340], [336, 290], [341, 336], [342, 313], [343, 336], [288, 344], [280, 288], [345, 280], [286, 346], [288, 286], [286, 244], [273, 280], [244, 273], [334, 347], [273, 334], [339, 244], [348, 339], [341, 339], [349, 341], [334, 341], [350, 174], [175, 351], [174, 175], [167, 352], [175, 167], [173, 174], [353, 173], [157, 173], [354, 157], [167, 157], [208, 207], [355, 208], [207, 356], [204, 357], [207, 204], [189, 204], [358, 189], [197, 359], [208, 197], [189, 197], 
            [199, 360], [359, 199], [361, 359], [354, 199], [362, 354], [354, 363], [364, 359], [365, 228], [229, 366], [228, 229], [225, 367], [229, 225], [360, 368], [369, 360], [220, 370], [228, 220], [198, 220], [225, 198], [360, 198], [219, 371], [370, 219], [372, 370], [353, 219], [373, 353], [369, 370], [362, 369], [353, 362], [369, 374], [362, 375], [256, 376], [249, 256], [377, 249], [256, 257], [257, 378], [249, 240], [240, 379], [216, 240], [257, 216], [371, 216], [380, 371], [381, 371], [187, 358], [382, 187], [358, 383], [352, 187], [363, 352], [364, 363], [358, 364], [352, 384], [385, 364], [386, 363], [271, 387], [272, 271], [388, 272], [266, 272], [389, 266], [260, 271], [390, 260], [186, 266], [260, 186], [382, 391], [392, 382], [186, 382], [390, 393], [259, 390], [394, 259], [391, 390], [395, 391], [351, 259], [384, 351], [391, 384], [351, 396], [384, 397], [379, 237], [398, 379], [237, 399], [381, 379], [373, 381], [350, 373], [237, 350], [381, 400], [396, 350], [401, 396], [402, 373], [403, 396], [289, 404], [281, 289], [405, 281], [287, 406], [289, 287], [287, 238], [258, 281], [238, 258], [394, 407], [258, 394], [399, 238], [408, 399], [401, 399], [409, 401], [394, 401], 
            [389, 392], [265, 389], [357, 265], [383, 357], [392, 383], [410, 389], [392, 411], [412, 265], [413, 357], [414, 383], [415, 332], [323, 416], [332, 323], [329, 417], [332, 329], [418, 297], [297, 323], [264, 329], [297, 264], [412, 264], [419, 412], [412, 420], [221, 355], [367, 221], [368, 367], [361, 368], [355, 361], [421, 221], [355, 422], [423, 367], [424, 368], [425, 361], [418, 426], [420, 418], [427, 420], [296, 418], [428, 296], [296, 356], [413, 420], [356, 413], [413, 429], [422, 430], [356, 422], [431, 422], [308, 432], [301, 308], [433, 301], [307, 308], [434, 307], [222, 295], [307, 222], [295, 301], [428, 435], [295, 428], [430, 428], [436, 430], [421, 437], [222, 421], [430, 421], [378, 252], [380, 378], [372, 380], [365, 372], [252, 365], [438, 378], [252, 439], [440, 380], [441, 372], [442, 365], [434, 443], [437, 434], [444, 437], [306, 434], [445, 306], [423, 437], [366, 423], [306, 366], [423, 446], [366, 442], [442, 447], [448, 442], [320, 449], [312, 320], [450, 312], [318, 320], [451, 318], [318, 253], [305, 312], [253, 305], [445, 452], [305, 445], [439, 453], [253, 439], [447, 439], [445, 447], [454, 447], [408, 406], [398, 408], [377, 398], [285, 377], 
            [406, 285], [455, 408], [406, 456], [457, 398], [458, 377], [459, 285], [348, 460], [338, 348], [461, 338], [346, 348], [462, 346], [317, 338], [284, 317], [346, 284], [317, 463], [284, 459], [459, 464], [465, 459], [453, 451], [466, 453], [451, 467], [438, 453], [376, 438], [316, 376], [451, 316], [438, 468], [463, 316], [469, 463], [458, 376], [470, 458], [465, 463], [458, 465], [465, 471], [407, 393], [405, 407], [283, 405], [387, 283], [393, 387], [472, 407], [393, 473], [474, 405], [475, 283], [476, 387], [419, 477], [417, 419], [478, 417], [410, 419], [479, 410], [328, 417], [388, 328], [410, 388], [328, 480], [388, 476], [476, 481], [482, 476], [347, 333], [483, 347], [333, 484], [345, 347], [282, 345], [327, 282], [333, 327], [345, 485], [480, 327], [486, 480], [475, 282], [487, 475], [482, 480], [475, 482], [482, 488], [489, 464], [462, 490], [464, 462], [456, 491], [464, 456], [485, 344], [492, 485], [344, 462], [404, 456], [344, 404], [474, 404], [493, 474], [487, 494], [485, 487], [474, 487], [343, 337], [342, 343], [315, 342], [326, 315], [337, 326], [495, 343], [337, 496], [497, 342], [498, 315], [499, 326], [426, 500], [435, 426], [501, 435], [416, 426], [502, 416], 
            [433, 435], [325, 433], [416, 325], [433, 503], [325, 499], [499, 504], [505, 499], [452, 443], [506, 452], [443, 507], [450, 452], [314, 450], [432, 314], [443, 432], [450, 508], [503, 432], [509, 503], [498, 314], [510, 498], [505, 503], [498, 505], [505, 511], [512, 469], [467, 513], [469, 467], [461, 514], [469, 461], [508, 449], [515, 508], [449, 467], [340, 461], [449, 340], [497, 340], [516, 497], [510, 517], [508, 510], [497, 510], [486, 518], [478, 486], [519, 478], [484, 486], [520, 484], [484, 335], [415, 478], [335, 415], [502, 521], [415, 502], [496, 522], [335, 496], [504, 496], [502, 504], [523, 504], [490, 524], [492, 490], [525, 492], [526, 514], [460, 490], [514, 460], [349, 483], [460, 349], [483, 492], [520, 527], [483, 520], [522, 520], [528, 522], [516, 529], [514, 516], [495, 516], [349, 495], [522, 495], [403, 397], [402, 403], [375, 402], [386, 375], [397, 386], [530, 403], [397, 531], [532, 402], [533, 375], [534, 386], [429, 535], [431, 429], [536, 431], [414, 429], [537, 414], [425, 431], [385, 425], [414, 385], [425, 538], [385, 534], [534, 539], [540, 534], [448, 446], [541, 448], [446, 542], [441, 448], [374, 441], [424, 374], [446, 424], [441, 543], 
            [538, 424], [544, 538], [533, 374], [545, 533], [540, 538], [533, 540], [540, 546], [547, 470], [468, 548], [470, 468], [457, 549], [470, 457], [543, 440], [550, 543], [440, 468], [400, 457], [440, 400], [532, 400], [551, 532], [545, 552], [543, 545], [532, 545], [481, 553], [479, 481], [554, 479], [473, 481], [555, 473], [473, 395], [411, 479], [395, 411], [537, 556], [411, 537], [531, 557], [395, 531], [539, 531], [537, 539], [558, 539], [491, 559], [493, 491], [560, 493], [561, 549], [455, 491], [549, 455], [409, 472], [455, 409], [472, 493], [555, 562], [472, 555], [557, 555], [563, 557], [551, 564], [549, 551], [530, 551], [409, 530], [557, 530], [521, 565], [519, 521], [566, 519], [521, 500], [500, 567], [519, 477], [554, 568], [477, 554], [556, 569], [554, 556], [427, 477], [500, 427], [535, 427], [570, 535], [556, 535], [509, 571], [501, 509], [567, 501], [572, 567], [507, 573], [509, 507], [570, 567], [574, 570], [507, 444], [436, 501], [444, 436], [536, 570], [436, 536], [542, 444], [575, 542], [544, 542], [576, 544], [536, 544], [513, 577], [515, 513], [578, 515], [575, 573], [579, 575], [573, 580], [506, 515], [573, 506], [581, 548], [466, 513], [548, 466], [454, 506], 
            [466, 454], [550, 548], [582, 550], [541, 550], [575, 541], [454, 541], [583, 581], [577, 584], [581, 577], [512, 526], [577, 512], [526, 585], [524, 586], [526, 524], [587, 561], [559, 588], [561, 559], [489, 524], [559, 489], [547, 561], [581, 547], [471, 547], [512, 471], [489, 471], [586, 589], [588, 586], [590, 588], [586, 525], [527, 591], [525, 527], [518, 566], [527, 518], [566, 592], [568, 593], [566, 568], [588, 560], [562, 594], [560, 562], [553, 568], [562, 553], [494, 560], [525, 494], [488, 494], [518, 488], [553, 488], [589, 595], [591, 589], [592, 591], [596, 592], [584, 597], [585, 584], [589, 585], [584, 578], [580, 598], [578, 580], [571, 572], [580, 571], [572, 599], [565, 592], [572, 565], [585, 529], [528, 591], [529, 528], [523, 565], [528, 523], [517, 529], [578, 517], [511, 517], [571, 511], [523, 511], [595, 596], [597, 595], [598, 597], [599, 598], [596, 599], [590, 595], [594, 590], [593, 594], [596, 593], [583, 597], [587, 583], [590, 587], [583, 582], [579, 598], [582, 579], [576, 574], [579, 576], [574, 599], [569, 593], [574, 569], [587, 564], [563, 594], [564, 563], [558, 569], [563, 558], [552, 564], [582, 552], [546, 552], [576, 546], [558, 546]
        ]


        import * as THREE from "https://unpkg.com/three/build/three.module.js";
        import {OrbitControls} from "https://unpkg.com/three/examples/jsm/controls/OrbitControls.js";

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 10;
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById("container").appendChild(renderer.domElement);

        const material = new THREE.RawShaderMaterial({
            uniforms: {
                rotate_4d: {value: new THREE.Matrix4(1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1.)}
            },
            vertexShader: `
                uniform mat4 projectionMatrix;
                uniform mat4 viewMatrix;
                uniform mat4 modelMatrix;

                attribute vec4 position;
                attribute vec4 normal;

                uniform mat4 rotate_4d;

                varying vec3 vNormal;

                void main()
                {
                    vec4 position_rotated = rotate_4d*position;
                    vec3 newPosition = -position_rotated.xyz/(1.-position_rotated.w);
                    vec4 normal_rotated = rotate_4d*normal;
                    vNormal = normal_rotated.xyz*(-1./(1.-position_rotated.w))-normal_rotated.w/((1.-position_rotated.w)*(1.-position_rotated.w))*position_rotated.xyz;
                    vNormal = vNormal/length(vNormal);
                    vNormal = mat3(viewMatrix) * vNormal;
                    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(newPosition, 1.0);
                }
            `,
            fragmentShader: `
                precision mediump float;

                varying vec3 vNormal;

                void main()
                {
                    // gl_FragColor = vec4(1., 0., 0., 1.);
                    // gl_FragColor = vec4(vNormal*0.5+0.5, 1.0);
                    // gl_FragColor = vec4(vec3(pow((vNormal).x, 2.)), 1.0);
                    // gl_FragColor = vec4(pow((vNormal).x, 2.)*0.8+vNormal*0.5+0.4, 1.0);
                    gl_FragColor = vec4((pow((vNormal).x, 2.)+0.2)*(vNormal*0.5+0.5)*2.5, 1.0);
                }
            `,
            side: THREE.DoubleSide
        });

        function vector_plus(u, v)
        {
            return [u[0]+v[0], u[1]+v[1], u[2]+v[2], u[3]+v[3]];
        }

        function vector_subtract(u, v)
        {
            return [u[0]-v[0], u[1]-v[1], u[2]-v[2], u[3]-v[3]];
        }

        function vector_scale(k, v)
        {
            return [k*v[0], k*v[1], k*v[2], k*v[3]];
        }

        function vector_dot(u, v)
        {
            return u[0]*v[0]+u[1]*v[1]+u[2]*v[2]+u[3]*v[3];
        }

        function vector_length(v)
        {
            return Math.sqrt(vector_dot(v, v));
        }

        function vector_normalize(v)
        {
            return vector_scale(1./vector_length(v), v);
        }

        function matrix_orthogonalize(vectors)
        {
            for(var i=0; i<vectors.length; i++)
            {
                for(var j=0; j<i; j++)
                {
                    vectors[i] = vector_subtract(vectors[i], vector_scale(vector_dot(vectors[i], vectors[j]), vectors[j]));
                }
                vectors[i] = vector_normalize(vectors[i]);
            }
        }

        function matrix_plus(m1, m2)
        {
            const result = [];

            for(var i=0; i<4; i++)
                result.push(vector_plus(m1[i], m2[i]));

            return result;
        }

        function matrix_scale(k, m)
        {
            const result = [];

            for(var i=0; i<4; i++)
                result.push(vector_scale(k, m[i]));

            return result;
        }

        function matrix_multiply(m1, m2)
        {
            const result = [
                [0, 0, 0, 0],
                [0, 0, 0, 0],
                [0, 0, 0, 0],
                [0, 0, 0, 0]
            ];

            for(var i=0; i<4; i++)
                for(var j=0; j<4; j++)
                    for(var k=0; k<4; k++)
                        result[i][j] += m1[i][k]*m2[k][j];

            return result;
        }

        function matrix_exp(m, order=10)
        {
            var result = [
                [1, 0, 0, 0],
                [0, 1, 0, 0],
                [0, 0, 1, 0],
                [0, 0, 0, 1]
            ];

            var a = [
                [1, 0, 0, 0],
                [0, 1, 0, 0],
                [0, 0, 1, 0],
                [0, 0, 0, 1]
            ];
            for(var i=1; i<=order; i++)
            {
                a = matrix_multiply(a, m);
                a = matrix_scale(1./i, a);
                result = matrix_plus(result, a);
            }

            return result;
        }

        // function inversion_number(list)
        // {
        //     var result = 0;

        //     for(var i=2; i<list.length; i++)
        //         for(var j=0; j<i; j++)
        //             if(list[j]>list[i])
        //                 result += 1;

        //     return result;
        // }

        // function matrix_det(m)
        // {
        //     var result = 0;
        //     for(var i=0; i<4; i++)
        //     {
        //         for(var j=0; j<4; j++)
        //         {
        //             if(j==i)
        //                 continue;
        //             const a = m[0][i]*m[1][j];
        //             for(var k=0; k<4; k++)
        //             {
        //                 if(k==i||k==j)
        //                     continue;
        //                 const b = a*m[2][k];
        //                 for(var l=0; l<4; l++)
        //                     if(l!=i&&l!=j&&l!=k)
        //                         result += (inversion_number([i, j, k, l])%2==0?1:-1)*b*m[3][l]
        //             }
        //         }
        //     }
        //     return result;        
        // }
        
        function matrix_flatten(m)
        {
            const result = [];

            for(var i=0; i<m.length; i++)
                result.push(...m[i]);

            return result;
        }

        function generate_cylinder_4d_on_sphere(positions, normals, indices, start, end, radius, phi_seg, h_seg)
        {
            start = vector_normalize(start);
            end = vector_normalize(end);
            const v = vector_subtract(end, start)
            const bases = [v, start, [1., 1.5, Math.E, 3.3], [Math.PI, 2., 1., 0.1]];
            matrix_orthogonalize(bases);
            // if(matrix_det(bases)<0)
            //     bases[3] = vector_scale(-1, bases[3]);

            const points_id_start = Math.round(positions.length/4);

            for(var i=0; i<=h_seg; i++)
            {
                const center = vector_plus(start, vector_scale(i/h_seg, v));
                for(var j=0; j<phi_seg; j++)
                {
                    const normal = vector_plus(
                        vector_scale(Math.cos((j+i*0.5)/phi_seg*2.*Math.PI), bases[2]),
                        vector_scale(Math.sin((j+i*0.5)/phi_seg*2.*Math.PI), bases[3]));
                    positions.push(...vector_normalize(vector_plus(center, vector_scale(radius, normal))));
                    normals.push(...normal);
                }
            }

            for(var i=0; i<h_seg; i++)
            {
                for(var j=0; j<phi_seg; j++)
                {
                    indices.push(points_id_start+i*phi_seg+j, points_id_start+i*phi_seg+(j+1)%phi_seg, points_id_start+(i+1)*phi_seg+j);
                    indices.push(points_id_start+i*phi_seg+(j+1)%phi_seg, points_id_start+(i+1)*phi_seg+(j+1)%phi_seg, points_id_start+(i+1)*phi_seg+j);
                }
            }
        }

        function generate_frame_4d_on_sphere(points, edges)
        {
            const positions = [];
            const normals = [];
            const indices = [];

            edges.forEach(edge=>
            {
                generate_cylinder_4d_on_sphere(positions, normals, indices, points[edge[0]], points[edge[1]], 0.03, 10, 12);
            });

            const position_3d = [];
            for(var i=0; i<positions.length; i++)
                if(i%4!=3)
                    position_3d.push(positions[i]);
            const triangle_mesh = new THREE.BufferGeometry();
            triangle_mesh.setAttribute('position', new THREE.BufferAttribute(new Float32Array(positions), 4));
            // console.log(position_3d);
            triangle_mesh.setAttribute('normal', new THREE.BufferAttribute(new Float32Array(normals), 4));
            triangle_mesh.setIndex(indices);
            // console.log(indices);

            return triangle_mesh;
        }

        // const geometry = new THREE.BoxGeometry(1, 1, 1);
        // geometry.computeVertexNormals();
        const geometry = generate_frame_4d_on_sphere(points, edges);
        const object = new THREE.Mesh(geometry, material);

        scene.add(object);

        // var time = 0.;
        // function animate() {
        //     requestAnimationFrame(animate);

        //     time += 0.02;
        //     object.material.uniforms.rotate_4d.value.set(
        //         1., 0., 0., 0.,
        //         0., 1., 0., 0.,
        //         0., 0., Math.cos(time*0.1), -Math.sin(time*0.1),
        //         0., 0., Math.sin(time*0.1), Math.cos(time*0.1));

        //     renderer.render(scene, camera);
        // }

        // animate();

        renderer.render(scene, camera);

        // var controls = new OrbitControls(camera, renderer.domElement);  //  
        // controls.target.set(0, 0, 0);
        // controls.addEventListener('change', ()=>{renderer.render(scene, camera)});//

        var tool = "3d rotate";
        var pointer_last_x, pointer_last_y;
        var rotate_4d_matrix = [
            [1, 0, 0, 0],
            [0, 1, 0, 0],
            [0, 0, 1, 0],
            [0, 0, 0, 1]
        ];

        const button_3d_rotate = document.getElementById('3d rotate');
        const button_4d_rotate = document.getElementById('4d rotate');

        button_3d_rotate.addEventListener('click', ()=>
        {
            tool = "3d rotate";
            button_3d_rotate.style.border = "3px solid white";
            button_4d_rotate.style.border = "3px solid rgba(0, 0, 0, 0)";
        });

        button_4d_rotate.addEventListener('click', ()=>
        {
            tool = "4d rotate";
            button_3d_rotate.style.border = "3px solid rgba(0, 0, 0, 0)";
            button_4d_rotate.style.border = "3px solid white";
        });

        document.getElementById("container").addEventListener('mousedown', function (event)
            {
                pointer_last_x = event.clientX;
                pointer_last_y = event.clientY;
            });

        document.getElementById("container").addEventListener('touchstart', function (event)
            {
                pointer_last_x = event.touches[0].clientX;
                pointer_last_y = event.touches[0].clientY;
            });

        document.getElementById("container").addEventListener('mousemove', function (event)
            {
                const x = event.clientX;
                const y = event.clientY;
                const dx = x-pointer_last_x;
                const dy = y-pointer_last_y;

                const factor1 = 3./((window.innerWidth+window.innerHeight)/2);
                const factor2 = factor1*0.6;

                if(event.buttons==1)
                    switch(tool)
                    {
                        case "3d rotate":
                            rotate_4d_matrix = matrix_multiply(matrix_exp([
                                [0, 0, dx*factor1, 0],
                                [0, 0, -dy*factor1, 0],
                                [-dx*factor1, dy*factor1, 0, 0],
                                [0, 0, 0, 0]
                            ]), rotate_4d_matrix);
                            matrix_orthogonalize(rotate_4d_matrix);
                            object.material.uniforms.rotate_4d.value.set(...matrix_flatten(rotate_4d_matrix));
                            renderer.render(scene, camera);
                            break;
                        case "4d rotate":
                            rotate_4d_matrix = matrix_multiply(matrix_exp([
                                [0, 0, 0, -dx*factor2],
                                [0, 0, 0, dy*factor2],
                                [0, 0, 0, 0],
                                [dx*factor2, -dy*factor2, 0, 0]
                            ]), rotate_4d_matrix);
                            matrix_orthogonalize(rotate_4d_matrix);
                            object.material.uniforms.rotate_4d.value.set(...matrix_flatten(rotate_4d_matrix));
                            renderer.render(scene, camera);
                            break;
                    }
                
                pointer_last_x = x;
                pointer_last_y = y;
            }, {passive: false});

        document.getElementById("container").addEventListener('touchmove', function (event)
            {
                const x = event.touches[0].clientX;
                const y = event.touches[0].clientY;
                const dx = x-pointer_last_x;
                const dy = y-pointer_last_y;

                const factor1 = 3./((window.innerWidth+window.innerHeight)/2);
                const factor2 = factor1*0.6;

                switch(tool)
                {
                    case "3d rotate":
                        rotate_4d_matrix = matrix_multiply(matrix_exp([
                            [0, 0, dx*factor1, 0],
                            [0, 0, -dy*factor1, 0],
                            [-dx*factor1, dy*factor1, 0, 0],
                            [0, 0, 0, 0]
                        ]), rotate_4d_matrix);
                        matrix_orthogonalize(rotate_4d_matrix);
                        object.material.uniforms.rotate_4d.value.set(...matrix_flatten(rotate_4d_matrix));
                        renderer.render(scene, camera);
                        break;
                    case "4d rotate":
                        rotate_4d_matrix = matrix_multiply(matrix_exp([
                            [0, 0, 0, -dx*factor2],
                            [0, 0, 0, dy*factor2],
                            [0, 0, 0, 0],
                            [dx*factor2, -dy*factor2, 0, 0]
                        ]), rotate_4d_matrix);
                        matrix_orthogonalize(rotate_4d_matrix);
                        object.material.uniforms.rotate_4d.value.set(...matrix_flatten(rotate_4d_matrix));
                        renderer.render(scene, camera);
                        break;
                }
                
                pointer_last_x = x;
                pointer_last_y = y;
            });

        document.getElementById("container").addEventListener('wheel', function (event)
            {
                camera.position.z *= Math.exp(event.wheelDeltaY*-0.001);
                renderer.render(scene, camera);
            });
    </script>
</body>
</html>